<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Comunit√°ria</title>
    <link rel="icon" href="/images/livro.png" type="image/png">
    <link rel="stylesheet" href="/assets/css/style.css">
    <script type="module" src="/assets/js/homepage.js" defer></script>
    <script type="module" src="/assets/js/modal.js" defer></script>
</head>
<body>

    <div id="bookstore-view" class="bookstore-view" style="display: block;">
        <header class="header">
            <h1 class="logo">üìö Biblioteca Comunit√°ria</h1>
            <div class="header-right">
                <a href="/donate" id="donate-btn" class="btn-doar">Doar Livro</a>
                
                <form action="/search-for" method="get" class="search-bar">
                    <input type="text" name="bookName" id="search-input" placeholder="Pesquisar livros...">
                    <button id="search-btn" type="submit">üîç</button>
                </form>
            </div>
        </header>

        <h2 class="header-subtitle">Encontre, resgate ou doe livros na comunidade</h2>

        <% if (currentUrl === '/search-for') { %>
            <a href="/" class="back-button2">Voltar</a>
        <% } %>

        <div id="book-list" class="book-list"></div>

        <div class="pagination">
            <% 
                const baseUrl = '/search-for?bookName=' + encodeURIComponent(bookName || '');
                const pageParam = '&page=';
            %>

            <% if (page > 1) { %>
                <a href="<%= baseUrl %><%= pageParam %><%= page - 1 %>" class="page-btn">&laquo; Anterior</a>
            <% } %>

            <% for (let i = 1; i <= totalPages; i++) { %>
                <a href="<%= baseUrl %><%= pageParam %><%= i %>" class="page-btn <%= page === i ? 'active' : '' %>"><%= i %></a>
            <% } %>

            <% if (page < totalPages) { %>
                <a href="<%= baseUrl %><%= pageParam %><%= page + 1 %>" class="page-btn">Pr√≥ximo &raquo;</a>
            <% } %>
        </div>
    </div>

    <div id="book-details-view" class="book-details-view">
        <button id="back-button" class="back-button">&larr; Voltar</button>
        <div id="book-details" class="book-details-container">
        </div>
    </div>
    
    <% if(alert) { %>
        <div id="message-modal" class="message-modal" style="display:flex;">
            <div class="message-box">
                <h3 id="modal-title"><%=alert.title %> </h3>
                <p id="modal-message"> <%=alert.message %> </p>
                <button id="close-modal">OK</button>
            </div>
        </div>
    <% } %>

    <!-- Aqui mandamos os dados para o JS -->
    <script id="books" type="application/json">
        <%- JSON.stringify(books) %>
    </script>
</body>
</html>